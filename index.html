<html>

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="./css/pico.min.css">
	<link rel="stylesheet" href="./css/app.css">
</head>

<body>
	<main class="container">
		<hgroup>
			<h1>New York <b>ACTUALLY HAS 12 SEASONS</b></h1>
			<h2><span id="explainer">Loading...</span></h2>
		</hgroup>

		<br>

		<ul>
			<li>Winter</li>
			<li>Fool's Spring</li>
			<li>Second Winter</li>
			<li>Spring of Deception</li>
			<li>Third Winter</li>
			<li>The Pollening</li>
			<li>Actual Spring</li>
			<li>Summer</li>
			<li>Hell's Front Porch</li>
			<li>False Fall</li>
			<li>Second Summer</li>
			<li>Actual Fall</li>
		</ul>

		<br>
		<br>

		<details>
			<Summary><small>About this page...</small></Summary>
			<p>
				This web page is based on <a class="secondary" href="https://i.imgur.com/qT4WqjG.jpg">this meme</a>.
			</p>

			<img src="https://i.imgur.com/qT4WqjG.jpg"
				alt="A list of 12 seasons of new york with an arrow pointed to 'The Pollening'" />

			<p>
				And, while the meme is simple, this web page is... not. It may even be a little over-engineered.
			</p>

			<h2>How this Works</h2>

			<p>
				My goal with this page to capture, not the <i>astrological</i> or <i>meterological</i> season of New
				York, but the <i>experiential</i> season of the New Yorker. A creature who lives their lives outside of
				the traditional American comforts of climate-controlled cars.
			</p>

			<p>
				For example, if it's a hot in late astrological Winter, the New Yorker's brain knows it's not spring,
				but is fooled into thinking they can wear a light jacket. Only to be sorely corrected by the city later
				that night.
			</p>

			<p>This is the New Yorker experiencing <b>Fool's Spring</b>.</p>

			<p>
				Therefore, this web-page <b>updates dynamically</b> based on the <b>day of the year</b>, the <b>hour of
					the day</b>, and the <b>real-time temperature in NYC</b>.
			</p>

			<p>It uses both live and 53 years of historical data from <a href="https://openweathermap.org/"
					class="secondary">OpenWeatherMap.org</a>.
			</p>

			<h2>Methodology</h2>

			<p>
				To start, I mapped the meme's seasons to a two-dimensional grid of astrological sub-season and the
				relative temperature of that season.
			</p>

			<p>
				This part is more feeling than science.
			</p>

			<h4>Winter</h4>
			<table class="seasons">
				<thead>
					<tr>
						<td>
							</th>
						<th>Early</th>
						<th>Mid</th>
						<th>Late</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<th>Cold</th>
						<td colspan="2" rowspan="2">Winter</td>
						<td rowspan="2">Second<br>Winter</td>
					</tr>
					<tr>
						<th>Mid</th>
					</tr>
					<tr>
						<th>Warm</th>
						<td colspan="3">Fools Spring</td>
					</tr>
			</table>


			<h4>Spring</h4>
			<table class="seasons">
				<thead>
					<tr>
						<td>
							</th>
						<th>Early</th>
						<th>Mid</th>
						<th>Late</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<th>Cold</th>
						<td colspan="3">Third Winter</td>
					</tr>
					<tr>
						<th>Mid</th>
						<td rowspan="2">Spring of<br>Deception</td>
						<td colspan="2">Actual Spring</td>
					</tr>
					<tr>
						<th>Warm</th>
						<td colspan="2">The Pollening</td>
					</tr>
			</table>

			<h4>Summer</h4>
			<table class="seasons">
				<thead>
					<tr>
						<td>
							</th>
						<th>Early</th>
						<th>Mid</th>
						<th>Late</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<th>Cold</th>
						<td colspan="2" rowspan="2">Summer</td>
						<td rowspan="2">False Fall</td>
					</tr>
					<tr>
						<th>Mid</th>
					</tr>
					<tr>
						<th>Warm</th>
						<td colspan="3">Hell's Front Porch</td>
					</tr>
			</table>

			<h4>Fall</h4>
			<table class="seasons">
				<thead>
					<tr>
						<td>
							</th>
						<th>Early</th>
						<th>Mid</th>
						<th>Late</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<th>Cold</th>
						<td colspan="3">Winter</td>
					</tr>
					<tr>
						<th>Mid</th>
						<td colspan="3">Actual Fall</td>
					</tr>
					<tr>
						<th>Warm</th>
						<td colspan="3">Second Summer</td>
					</tr>
			</table>

			<p>
				Next, I needed to define these axes.
			</p>

			<h3>Sub-Seasons</h3>

			<p>
				For the early, mid, and late I divided the seasons by into three roughly equal segments using their
				astrological definitions.
			</p>

			<table>
				<thead>
					<tr>
						<td></td>
						<th>Span</th>
						<th>Start</th>
						<th>End</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<th rowspan="3">Winter</th>
						<th>Early</th>
						<td>Dec 21</td>
						<td>Jan 20</td>
					</tr>
					<tr>
						<th>Mid</th>
						<td>Jan 20</td>
						<td>Feb 19</td>
					</tr>
					<tr>
						<th>Late</th>
						<td>Feb 19</td>
						<td>Mar 20</td>
					<tr>
						<th rowspan="3">Spring</th>
						<th>Early</th>
						<td>Mar 20</td>
						<td>Apr 19</td>
					</tr>
					<tr>
						<th>Mid</th>
						<td>Apr 19</td>
						<td>May 19</td>
					</tr>
					<tr>
						<th>Late</th>
						<td>May 22</td>
						<td>Jun 21</td>
					</tr>
					<tr>
						<th rowspan="3">Summer</th>
						<th>Early</th>
						<td>Jun 21</td>
						<td>Jul 21</td>
					</tr>
					<tr>
						<th>Mid</th>
						<td>Jul 21</td>
						<td>Aug 22</td>
					</tr>
					<tr>
						<th>Late</th>
						<td>Aug 22</td>
						<td>Sep 22</td>
					</tr>
					<tr>
						<th rowspan="3">Fall</th>
						<th>Early</th>
						<td>Sep 22</td>
						<td>Oct 22</td>
					</tr>
					<tr>
						<th>Mid</th>
						<td>Oct 22</td>
						<td>Nov 21</td>
					</tr>
					<tr>
						<th>Late</th>
						<td>Nov 21</td>
						<td>Dec 21</td>
					</tr>
				</tbody>
			</table>

			<p><small><i>Ranges are inclusive start and exclusive end.</i></small></p>

			<h3>Historical Temperature Distributions</h3>

			<p>
				Next, I built a baseline for NYC weather by day of year and hour of day. I pulled hourly temperature
				data for NYC from Jan 1 1979 to Jan 1 2023 and computed a median and standard deviation for every hour
				of every day of the year.
			</p>

			<p>
				If you're interested in exploring this data, it's available in the repo <a class="secondary"
					href="https://github.com/x/nyc-seasons">here</a>.
			</p>

			<pre>import pandas as pd
weather_df = pd.read_csv("nyc_weather.csv")
weather_df["dt_datetime"] = pd.to_datetime(weather_df.dt_iso.str.replace(" UTC", ""))
weather_df["day_hour"] = weather_df.dt_datetime.dt.strftime("%j-%H")
weather_df = weather_df.groupby(by="day_hour").aggregate({"feels_like": ["mean", "std"]})
hour_temps_df = df.groupby(by="day_hour").aggregate({"feels_like": ["mean", "std"]})["feels_like"]
import json
hour_temps_json = json.dumps(hour_temps_df.to_dict("index"))</pre>

			<p>
				From here, we say that a "hot" day is anything that is 1.5 standard deviations above the mean and a
				"cold" day is anything that is 1.5 standard deviations below the mean.
			</p>

			<p>
				Now that we have a baseline for what is "normal" we can dynamically compare the current temperature our
				baseline and decide if it's hot out by calling <a href="https://openweathermap.org/"
					class="secondary">OpenWeatherMap.org</a> every time the page loads. We use Time Square for our live
				temperature reading and compare it to our historical distribution.
			</p>

			<h3>Deciding the Season</h3>

			<p>
				Using these features we update the arrow using the above logic. If it's late Winter, and we're 1.5
				stddevs above the average for this day and hour, we're in 'Fool's Spring'. An explainer to the data we
				used to make this decision is appended below the header.
			</p>

			<p>
				This page was made by <a class="secondary" href="https://peticol.as">Devon Peticolas</a>. If you'd like
				to see the source, fork, or suggest a change please check out its repo <a class="secondary"
					href="https://github.com/x/nyc-seasons">on github</a>.
			</p>
		</details>

	</main>
	<script src="./js/temps.js"></script>
	<script src="./js/app.js"></script>
	<script data-goatcounter="https://12seasons.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</body>

</html>
